<!--modal image update-->
<div class="modal fade" id="updateImageModal" tabindex="-1" aria-labelledby="updateModalImageLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl modal-dialog-scrollable">
        <div class="modal-content" *ngIf='selectedItem'>
            <div class="modal-header">
                <h2 class="modal-title" id="updateModalImageLabel">Choix de l'image</h2>
                <button type="button" class="btn-close" data-toggle="modal" data-target="#updateModal"
                    data-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <h3>Liste des images</h3>
                <form>
                    <table class="table">
                        <thead class="thead-dark">
                            <tr>
                                <th scope="col">Nom du fichier</th>
                                <th scope="col">Description</th>
                                <th scope="col">Visualisation</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let image of images;trackBy:util.trackById"
                                (click)="selectedItem.sourceImage=image">
                                <td>{{image.fileName}}</td>
                                <td>{{image.description}}</td>
                                <td><img src="{{urlDownload}}{{image.gridId}}" class="img-thumbnail" width="80" /></td>
                            </tr>
                        </tbody>
                    </table>
                </form>
                <div class="mb-3" *ngIf="selectedItem.sourceImage">
                    <label>Image sélectionnée:</label>
                    <div class="mb-3">
                        <img src="{{urlDownload}}{{selectedItem.sourceImage.gridId}}" class="img-thumbnail text-center"
                            width="80" />
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-toggle="modal" data-target="#updateModal"
                    data-dismiss="modal">Fermer</button>
            </div>
        </div>
    </div>
</div>

<!--modal image-->
<div class="modal fade" id="addImageModal" tabindex="-1" aria-labelledby="selectImageModalLabel" aria-hidden="true">
    <div class="modal-dialog  modal-xl modal-dialog-scrollable">
        <div class="modal-content ">
            <div class="modal-header">
                <h2 class="modal-title" id="selectImageModalLabel">Choix de l'image</h2>
                <button type="button" class="btn-close" data-toggle="modal" data-target="#addModal" data-dismiss="modal"
                    aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <h3>Liste des images</h3>
                <form>
                    <table class="table">
                        <thead class="thead-dark">
                            <tr>
                                <th scope="col">Nom du fichier</th>
                                <th scope="col">Description</th>
                                <th scope="col">Visualisation</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let image of images;trackBy:util.trackById" (click)="onSelect(image)">
                                <td>{{image.fileName}}</td>
                                <td>{{image.description}}</td>
                                <td><img src="{{urlDownload}}{{image.gridId}}" class="img-thumbnail" width="80" /></td>
                            </tr>
                        </tbody>
                    </table>
                </form>
                <div class="mb-3" *ngIf="selectedImage">
                    <label>Image sélectionnée:</label>
                    <div class="mb-3">
                        <img src="{{urlDownload}}{{selectedImage.gridId}}" class="img-thumbnail text-center"
                            width="80" />
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-toggle="modal" data-target="#addModal"
                    data-dismiss="modal">Fermer</button>
            </div>
        </div>
    </div>
</div>

<!-- modal Options add-->
<div class="modal fade" id="addModalOptions" aria-labelledby="addModalOptionsLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl modal-fullscreen-md-down modal-dialog-scrollable">
        <div class="modal-content ">
            <div class="modal-header">
                <h2 class="modal-title" id="addModalOptionsLabel">Choix des options</h2>
                <button type="button" class="btn-close" data-dismiss="modal" data-toggle="modal" data-target="#addModal"
                    aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div cdkDropListGroup>
                    <div class="row">
                        <div class="allergene-container col-6">
                            <h2>Options disponibles</h2>

                            <div cdkDropList [cdkDropListData]="options" class="allergene-list"
                                (cdkDropListDropped)="drop($event)">
                                <div class="allergene-box"
                                    *ngFor="let option of options;let id=index;trackBy:util.trackById" cdkDrag>
                                    <h3>{{option.label}}</h3>
                                    <div style="display: inline-block;width: 300px;">
                                        <ng-container *ngIf="option.unique">
                                            <div *ngFor="let choix of option.options;let idx=index">
                                                <div (*ngif)="option.unique" class="form-check">
                                                    <input class="form-check-input" type="radio"
                                                        name="flexRadioDefault{{id}}" id="Default{{idx}}">
                                                    <label class="form-check-label" for="Default{{idx}}">
                                                        {{choix.label}} <span
                                                            *ngIf="choix.price>0">{{choix.price}}€</span>
                                                    </label>
                                                </div>
                                            </div>
                                        </ng-container>
                                        <ng-container *ngIf="!option.unique">
                                            <div *ngFor="let choix of option.options;let idx=index">
                                                <div (*ngif)="option.unique" class="form-check">
                                                    <input class="form-check-input" type="checkbox">
                                                    <label class="form-check-label" for="DefaultC{{idx}}">
                                                        {{choix.label}} <span
                                                            *ngIf="choix.price>0">{{choix.price}}€</span>
                                                    </label>
                                                </div>
                                            </div>
                                        </ng-container>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="allergene-container col-6">
                            <h2>Options choisies</h2>

                            <div cdkDropList [cdkDropListData]="optionsSelected" class="allergene-list"
                                (cdkDropListDropped)="drop($event)">
                                <div class="allergene-box"
                                    *ngFor="let option of optionsSelected;let id =index;trackBy:util.trackById" cdkDrag>
                                    <h3>{{option.label}}</h3>
                                    <div style="display: inline-block;width: 300px;">
                                        <ng-container *ngIf="option.unique">
                                            <div *ngFor="let choix of option.options;let idx=index">
                                                <div (*ngif)="option.unique" class="form-check">
                                                    <input class="form-check-input" type="radio"
                                                        name="flexRadioDefault{{id}}" id="1Default{{idx}}">
                                                    <label class="form-check-label" for="1Default{{idx}}">
                                                        {{choix.label}} <span
                                                            *ngIf="choix.price>0">{{choix.price}}€</span>
                                                    </label>
                                                </div>
                                            </div>
                                        </ng-container>
                                        <ng-container *ngIf="!option.unique">
                                            <div *ngFor="let choix of option.options;let idx=index">
                                                <div (*ngif)="option.unique" class="form-check">
                                                    <input class="form-check-input" type="checkbox">
                                                    <label class="form-check-label" for="1DefaultC{{idx}}">
                                                        {{choix.label}} <span
                                                            *ngIf="choix.price>0">{{choix.price}}€</span>
                                                    </label>
                                                </div>
                                            </div>
                                        </ng-container>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-toggle="modal" data-target="#addModal"
                    data-dismiss="modal">Fermer</button>
            </div>
        </div>
    </div>
</div>

<!-- modal Options update-->
<div class="modal fade" id="updateModalOptions" aria-labelledby="updateModalOptionsLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl modal-fullscreen-md-down modal-dialog-scrollable">
        <div *ngIf="selectedItem" class="modal-content ">
            <div class="modal-header">
                <h2 class="modal-title" id="updateModalOptionsLabel">Choix des options</h2>
                <button type="button" class="btn-close" data-dismiss="modal" data-toggle="modal"
                    data-target="#updateModal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div cdkDropListGroup>
                    <div class="row">
                        <div class="allergene-container col-6">
                            <h2>Options disponibles</h2>

                            <div cdkDropList [cdkDropListData]="options" class="allergene-list"
                                (cdkDropListDropped)="drop($event)">
                                <div class="allergene-box"
                                    *ngFor="let option of options;let id=index;trackBy:util.trackById" cdkDrag>
                                    <h3>{{option.label}}</h3>
                                    <div style="display: inline-block;width: 300px;">
                                        <ng-container *ngIf="option.unique">
                                            <div *ngFor="let choix of option.options;let idx=index">
                                                <div (*ngif)="option.unique" class="form-check">
                                                    <input class="form-check-input" type="radio"
                                                        name="flexRadioDefault{{id}}" id="Default{{idx}}">
                                                    <label class="form-check-label" for="Default{{idx}}">
                                                        {{choix.label}} <span
                                                            *ngIf="choix.price>0">{{choix.price}}€</span>
                                                    </label>
                                                </div>
                                            </div>
                                        </ng-container>
                                        <ng-container *ngIf="!option.unique">
                                            <div *ngFor="let choix of option.options;let idx=index">
                                                <div (*ngif)="option.unique" class="form-check">
                                                    <input class="form-check-input" type="checkbox">
                                                    <label class="form-check-label" for="DefaultC{{idx}}">
                                                        {{choix.label}} <span
                                                            *ngIf="choix.price>0">{{choix.price}}€</span>
                                                    </label>
                                                </div>
                                            </div>
                                        </ng-container>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="allergene-container col-6">
                            <h2>Options choisies</h2>

                            <div cdkDropList [cdkDropListData]="this.selectedItem.options" class="allergene-list"
                                (cdkDropListDropped)="drop($event)">
                                <div class="allergene-box"
                                    *ngFor="let option of this.selectedItem.options;trackBy:util.trackById;let id=index"
                                    cdkDrag>
                                    <h3>{{option.label}}</h3>
                                    <div style="display: inline-block;width: 300px;">
                                        <ng-container *ngIf="option.unique">
                                            <div *ngFor="let choix of option.options;let idx=index">
                                                <div (*ngif)="option.unique" class="form-check">
                                                    <input class="form-check-input" type="radio"
                                                        name="flexRadioDefault{{id}}" id="Default{{idx}}">
                                                    <label class="form-check-label" for="Default{{idx}}">
                                                        {{choix.label}} <span
                                                            *ngIf="choix.price>0">{{choix.price}}€</span>
                                                    </label>
                                                </div>
                                            </div>
                                        </ng-container>
                                        <ng-container *ngIf="!option.unique">
                                            <div *ngFor="let choix of option.options;let idx=index">
                                                <div (*ngif)="option.unique" class="form-check">
                                                    <input class="form-check-input" type="checkbox">
                                                    <label class="form-check-label" for="DefaultC{{idx}}">
                                                        {{choix.label}} <span
                                                            *ngIf="choix.price>0">{{choix.price}}€</span>
                                                    </label>
                                                </div>
                                            </div>
                                        </ng-container>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-toggle="modal" data-target="#updateModal"
                    data-dismiss="modal">Fermer</button>
            </div>
        </div>
    </div>
</div>

<!-- modal promotion add-->
<div class="modal fade" id="addModalPromotion" aria-labelledby="addModalPromotionLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl modal-fullscreen-md-down modal-dialog-scrollable">
        <div class="modal-content ">
            <div class="modal-header">
                <h2 class="modal-title" id="addModalPromotionLabel">Choix des promotionss</h2>
                <button type="button" class="btn-close" data-dismiss="modal" data-toggle="modal" data-target="#addModal"
                    aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div cdkDropListGroup>
                    <div class="row">
                        <div class="allergene-container col-6">
                            <h2>Promotions disponibles</h2>
                            <div cdkDropList [cdkDropListData]="promotions" class="allergene-list"
                                (cdkDropListDropped)="drop($event)">
                                <div class="allergene-box" *ngFor="let promotion of promotions;trackBy:util.trackById"
                                    cdkDrag>
                                        <p>{{promotion.name}} {{promotion.reduction}}<span *ngIf="promotion.pourcentage">%</span><span *ngIf="!promotion.pourcentage">€</span> valable du {{promotion.dateDebut}} au {{promotion.dateFin}} de
                                            {{promotion.heureDebut}} à {{promotion.heureFin}}
                                            <span *ngIf="promotion.jourValide[0]">lundi </span>
                                            <span *ngIf="promotion.jourValide[1]">mardi </span>
                                            <span *ngIf="promotion.jourValide[2]">mercredi </span>
                                            <span *ngIf="promotion.jourValide[3]">jeudi </span>
                                            <span *ngIf="promotion.jourValide[4]">vendredi </span>
                                            <span *ngIf="promotion.jourValide[5]">samedi </span>
                                            <span *ngIf="promotion.jourValide[6]">dimanche </span>
                                            <span *ngIf="promotion.jourFerie">et jours fériés</span>
                                        </p>
                                </div>
                           </div>
                        </div>

                        <div class="allergene-container col-6">
                            <h2>Promotions choisies</h2>
                            <div cdkDropList [cdkDropListData]="promotionsSelected" class="allergene-list"
                                (cdkDropListDropped)="drop($event)">
                                <div class="allergene-box" *ngFor="let promotion of promotionsSelected;trackBy:util.trackById"
                                    cdkDrag>
                                        <p>{{promotion.name}} {{promotion.reduction}}<span *ngIf="promotion.pourcentage">%</span><span *ngIf="!promotion.pourcentage">€</span> valable du {{promotion.dateDebut}} au {{promotion.dateFin}} de
                                            {{promotion.heureDebut}} à {{promotion.heureFin}}
                                            <span *ngIf="promotion.jourValide[0]">lundi </span>
                                            <span *ngIf="promotion.jourValide[1]">mardi </span>
                                            <span *ngIf="promotion.jourValide[2]">mercredi </span>
                                            <span *ngIf="promotion.jourValide[3]">jeudi </span>
                                            <span *ngIf="promotion.jourValide[4]">vendredi </span>
                                            <span *ngIf="promotion.jourValide[5]">samedi </span>
                                            <span *ngIf="promotion.jourValide[6]">dimanche </span>
                                            <span *ngIf="promotion.jourFerie">et jours fériés</span>
                                        </p>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-toggle="modal" data-target="#addModal"
                    data-dismiss="modal">Fermer</button>
            </div>
        </div>
    </div>
</div>

<!-- modal promotion update-->
<div class="modal fade" id="updateModalPromotion" aria-labelledby="updateModalPromotionLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl modal-fullscreen-md-down modal-dialog-scrollable">
        <div class="modal-content" *ngIf="selectedItem">
            <div class="modal-header">
                <h2 class="modal-title" id="updateModalPromotionLabel">Choix des promotionss</h2>
                <button type="button" class="btn-close" data-dismiss="modal" data-toggle="modal" data-target="#updateModal"
                    aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div cdkDropListGroup>
                    <div class="row">
                        <div class="allergene-container col-6">
                            <h2>Promotions disponibles</h2>
                            <div cdkDropList [cdkDropListData]="promotions" class="allergene-list"
                                (cdkDropListDropped)="drop($event)">
                                <div class="allergene-box" *ngFor="let promotion of promotions;trackBy:util.trackById"
                                    cdkDrag>
                                        <p>{{promotion.name}} {{promotion.reduction}}<span *ngIf="promotion.pourcentage">%</span><span *ngIf="!promotion.pourcentage">€</span> valable du {{promotion.dateDebut}} au {{promotion.dateFin}} de
                                            {{promotion.heureDebut}} à {{promotion.heureFin}}
                                            <span *ngIf="promotion.jourValide[0]">lundi </span>
                                            <span *ngIf="promotion.jourValide[1]">mardi </span>
                                            <span *ngIf="promotion.jourValide[2]">mercredi </span>
                                            <span *ngIf="promotion.jourValide[3]">jeudi </span>
                                            <span *ngIf="promotion.jourValide[4]">vendredi </span>
                                            <span *ngIf="promotion.jourValide[5]">samedi </span>
                                            <span *ngIf="promotion.jourValide[6]">dimanche </span>
                                            <span *ngIf="promotion.jourFerie">et jours fériés</span>
                                        </p>
                                </div>
                           </div>
                        </div>

                        <div class="allergene-container col-6">
                            <h2>Promotions choisies</h2>
                            <div cdkDropList [cdkDropListData]="selectedItem.promotions" class="allergene-list"
                                (cdkDropListDropped)="drop($event)">
                                <div class="allergene-box" *ngFor="let promotion of selectedItem.promotions;trackBy:util.trackById"
                                    cdkDrag>
                                        <p>{{promotion.name}} {{promotion.reduction}}<span *ngIf="promotion.pourcentage">%</span><span *ngIf="!promotion.pourcentage">€</span> valable du {{promotion.dateDebut}} au {{promotion.dateFin}} de
                                            {{promotion.heureDebut}} à {{promotion.heureFin}}
                                            <span *ngIf="promotion.jourValide[0]">lundi </span>
                                            <span *ngIf="promotion.jourValide[1]">mardi </span>
                                            <span *ngIf="promotion.jourValide[2]">mercredi </span>
                                            <span *ngIf="promotion.jourValide[3]">jeudi </span>
                                            <span *ngIf="promotion.jourValide[4]">vendredi </span>
                                            <span *ngIf="promotion.jourValide[5]">samedi </span>
                                            <span *ngIf="promotion.jourValide[6]">dimanche </span>
                                            <span *ngIf="promotion.jourFerie">et jours fériés</span>
                                        </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-toggle="modal" data-target="#updateModal"
                    data-dismiss="modal">Fermer</button>
            </div>
        </div>
    </div>
</div>

<!-- modal allergene update-->
<div class="modal fade" id="updateModalAllergene" aria-labelledby="updateModalAllergeneLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl modal-fullscreen-md-down modal-dialog-scrollable">
        <div class="modal-content" *ngIf="selectedItem">
            <div class="modal-header">
                <h2 class="modal-title" id="updateModalAllergeneLabel">Choix des allergenes</h2>
                <button type="button" class="btn-close" data-dismiss="modal" data-toggle="modal"
                    data-target="#updateModal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div cdkDropListGroup>
                    <div class="row">
                        <div class="allergene-container col-6">
                            <h2>Allergenes disponibles</h2>

                            <div cdkDropList [cdkDropListData]="allergenes" class="allergene-list"
                                (cdkDropListDropped)="drop($event)">
                                <div class="allergene-box" *ngFor="let item of allergenes;trackBy:util.trackById"
                                    cdkDrag>{{item.name}}</div>
                            </div>
                        </div>

                        <div class="allergene-container col-6">
                            <h2>Allergenes choisis</h2>

                            <div cdkDropList [cdkDropListData]="selectedItem.allergenes" class="allergene-list"
                                (cdkDropListDropped)="drop($event)">
                                <div class="allergene-box"
                                    *ngFor="let item of selectedItem.allergenes;trackBy:util.trackById()" cdkDrag>
                                    {{item.name}}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-toggle="modal" data-target="#updateModal"
                    data-dismiss="modal">Fermer</button>
            </div>
        </div>
    </div>
</div>

<!-- modal allergene add-->
<div class="modal fade" id="addModalAllergene" aria-labelledby="addModalAllergeneLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl modal-fullscreen-md-down modal-dialog-scrollable">
        <div class="modal-content ">
            <div class="modal-header">
                <h2 class="modal-title" id="addModalAllergeneLabel">Choix des allergenes</h2>
                <button type="button" class="btn-close" data-dismiss="modal" data-toggle="modal" data-target="#addModal"
                    aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div cdkDropListGroup>
                    <div class="row">
                        <div class="allergene-container col-6">
                            <h2>Allergenes disponibles</h2>

                            <div cdkDropList [cdkDropListData]="allergenes" class="allergene-list"
                                (cdkDropListDropped)="drop($event)">
                                <div class="allergene-box" *ngFor="let item of allergenes;trackBy:util.trackById"
                                    cdkDrag>{{item.name}}</div>
                            </div>
                        </div>

                        <div class="allergene-container col-6">
                            <h2>Allergenes choisis</h2>

                            <div cdkDropList [cdkDropListData]="allergenesAdd" class="allergene-list"
                                (cdkDropListDropped)="drop($event)">
                                <div class="allergene-box" *ngFor="let item of allergenesAdd;trackBy:util.trackById"
                                    cdkDrag>{{item.name}}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-toggle="modal" data-target="#addModal"
                    data-dismiss="modal">Fermer</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal add-->
<div class="modal fade" id="addModal" data-backdrop="static" data-keyboard="false" tabindex="-1"
    aria-labelledby="addModaLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl modal-dialog-scrollable">
        <div class="modal-content">
            <form [formGroup]="addForm" (ngSubmit)="addData()">
                <div class="modal-header">
                    <h3 class="modal-title" id="addModaLabel">Ajout d'un item</h3>
                    <button type="button" class="btn-close" data-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div>
                        <div class="mb-3">
                            <label class="form-label" for="addNam1">Nom:</label>
                            <input id="addNam1" formControlName="name" required type="text" class="form-control"
                                placeholder="Nom" />
                        </div>

                        <div class="mb-3">
                            <label class="form-label" for="addDes1">Description:</label>
                            <input id="addDes1" formControlName="description" type="text" class="form-control"
                                placeholder="Description" />
                        </div>

                        <div class="mb-3">
                            <label class="form-label" for="addx">Prix:</label>
                            <div class="input-group mb-3" style="max-width: 200px;">
                                <input id="addx" formControlName="price" type="number" min="0.1" step="0.01"
                                    class="form-control" placeholder="Montant" aria-label="Montant"
                                    aria-describedby="basic-addon1">
                                <span class="input-group-text" id="basic-addon1">€</span>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label class="form-label" for="addCt">Choix du taux TVA:</label>
                            <select formControlName="tva" id="addCt" class="form-select" aria-label="Default select">
                                <option *ngFor="let tva of tvas;let idx=index;trackBy:util.trackById;"
                                    [selected]=" idx == 0 ? true : false" [ngValue]="tva">{{tva.taux}}%</option>
                            </select>
                        </div>


                        <div class="mb-3">
                            <label class="form-label" for="addCv">Choix de la categorie:</label>
                            <select formControlName="categorie" id="addCv" class="form-select"
                                aria-label="Default select">
                                <option *ngFor="let categorie of categories;let idx=index;trackBy:util.trackById"
                                    [selected]=" idx == 0 ? true : false" [ngValue]="categorie">{{categorie.name}}
                                </option>
                            </select>
                        </div>


                        <div class="mb-3">
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="flexSwitchCheckChecked"
                                    formControlName="visible">
                                <label class="form-check-label" for="flexSwitchCheckChecked">Visibilité</label>
                            </div>
                        </div>

                        <table class="table">
                            <thead>
                                <tr>
                                    <th scope="col">
                                        <div class="mb-3">
                                            <button type="button" class="btn btn-info" (click)="addSelectImage()">
                                                Image
                                            </button>
                                        </div>
                                    </th>
                                    <th scope="col">
                                        <div class="mb-3">
                                            <button type="button" class="btn btn-info" (click)="addSelectAllergene()">
                                                Allergenes
                                            </button>
                                        </div>
                                    </th>
                                    <th scope="col">
                                        <div class="mb-3">
                                            <button type="button" class="btn btn-info" (click)="addSelectedOptions()">
                                                Options
                                            </button>
                                        </div>
                                    </th>
                                    <th scope="col">
                                        <div class="mb-3">
                                            <button type="button" class="btn btn-info"
                                                (click)="addSelectedPromotions()">
                                                Stratégie de promotions
                                            </button>
                                        </div>
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <th scope="row">
                                        <div class="mb-3">
                                            <div class="mb-3" *ngIf="selectedImage">
                                                <img src="{{urlDownload}}{{selectedImage.gridId}}"
                                                    class="img-thumbnail text-center" width="170" />
                                            </div>
                                        </div>
                                    </th>
                                    <td>
                                        <div class="mb-3">
                                            <ul>
                                                <li *ngFor="let allergene of allergenesAdd;trackBy:util.trackById">
                                                    {{allergene.name}}</li>
                                            </ul>
                                        </div>
                                    </td>
                                    <td>
                                        <div class="allergene-box"
                                            *ngFor="let option of optionsSelected;trackBy:util.trackById;let id=index">
                                            <div style="display: inline-block;width: 300px;">
                                                <ng-container *ngIf="option.unique">
                                                    <h3>{{option.label}}</h3>
                                                    <div *ngFor="let choix of option.options;let idx=index">
                                                        <div (*ngif)="option.unique" class="form-check">
                                                            <input class="form-check-input" type="radio"
                                                                name="flexRadioDefault{{id}}" id="Default{{idx}}">
                                                            <label class="form-check-label" for="Default{{idx}}">
                                                                {{choix.label}} <span
                                                                    *ngIf="choix.price>0">{{choix.price}}€</span>
                                                            </label>
                                                        </div>
                                                    </div>
                                                </ng-container>
                                                <ng-container *ngIf="!option.unique">
                                                    <h3>{{option.label}}</h3>
                                                    <div *ngFor="let choix of option.options;let idx=index">
                                                        <div (*ngif)="option.unique" class="form-check">
                                                            <input class="form-check-input" type="checkbox">
                                                            <label class="form-check-label" for="DefaultC{{idx}}">
                                                                {{choix.label}} <span
                                                                    *ngIf="choix.price>0">{{choix.price}}€</span>
                                                            </label>
                                                        </div>
                                                    </div>
                                                </ng-container>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <div class="mb-3" *ngFor="let promotion of promotionsSelected;trackBy:util.trackById">
                                            <label>{{promotion.name}}</label>
                                            <p>{{promotion.reduction}}<span *ngIf="promotion.pourcentage">%</span><span *ngIf="!promotion.pourcentage">€</span> valable du {{promotion.dateDebut}} au {{promotion.dateFin}} de
                                                {{promotion.heureDebut}} à {{promotion.heureFin}}
                                                <span *ngIf="promotion.jourValide[0]">lundi </span>
                                                <span *ngIf="promotion.jourValide[1]">mardi </span>
                                                <span *ngIf="promotion.jourValide[2]">mercredi </span>
                                                <span *ngIf="promotion.jourValide[3]">jeudi </span>
                                                <span *ngIf="promotion.jourValide[4]">vendredi </span>
                                                <span *ngIf="promotion.jourValide[5]">samedi </span>
                                                <span *ngIf="promotion.jourValide[6]">dimanche </span>
                                                <span *ngIf="promotion.jourFerie">et jours fériés</span>
                                            </p>
                                            <hr/>
                                        </div>   

                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">fermer</button>
                    <button type="submit" class="btn btn-primary">
                        Ajouter
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Modal update-->
<div class="modal fade" id="updateModal" data-backdrop="static" data-keyboard="false" tabindex="-1"
    aria-labelledby="updateModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl modal-dialog-scrollable">
        <div class="modal-content ">
            <form [formGroup]="updateForm" (ngSubmit)="onUpdate()">
                <div class="modal-header">
                    <h3 class="modal-title" id="updateModalLabel">Modification de l'item</h3>
                    <button type="button" class="btn-close" data-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div *ngIf="selectedItem">
                        <div class="mb-3">
                            <label class="form-label" for="addNam">Nom:</label>
                            <input id="addNam" required formControlName="name" type="text" class="form-control"
                                placeholder="Nom" />
                        </div>

                        <div class="mb-3">
                            <label class="form-label" for="addDes">Description:</label>
                            <input id="addDes" required formControlName="description" type="text" class="form-control"
                                placeholder="Description" />
                        </div>

                        <div class="mb-3">
                            <label class="form-label" for="addP">Prix:</label>
                            <div class="input-group mb-3" style="max-width: 200px;">
                                <input id="addP" required formControlName="price" type="number" min="0.1" step="0.01"
                                    class="form-control" placeholder="Montant" aria-label="Montant"
                                    aria-describedby="basic-addon1">
                                <span class="input-group-text" id="basic-addon1">€</span>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label class="form-label" for="addC1">Choix du taux TVA:</label>
                            <select [compareWith]="compareFn" formControlName="tva" id="addC1" class="form-select"
                                aria-label="Default select">
                                <option *ngFor="let tva of tvas;let idx=index;trackBy:util.trackById;" [ngValue]="tva">
                                    {{tva.taux}}%</option>
                            </select>
                        </div>

                        <div class="mb-3">
                            <label class="form-label" for="addC">Choix de la categorie:</label>
                            <select [compareWith]="compareFn" formControlName="categorie" id="addC" class="form-select"
                                aria-label="Default select">
                                <option *ngFor="let categorie of categories;let idx=index;trackBy:util.trackById"
                                    [ngValue]="categorie">
                                    {{categorie.name}}</option>
                            </select>
                        </div>

                        <div class="mb-3">
                            <div class="form-check form-switch">
                                <label class="form-check-label" for="flexSwitch">Visibilité</label>
                                <input class="form-check-input" type="checkbox" id="flexSwitch"
                                    formControlName="visible">
                            </div>
                        </div>
                        <table class="table">
                            <thead>
                                <tr>
                                    <th scope="col">
                                        <div class="mb-3">
                                            <button type="button" class="btn btn-info" (click)="updateSelectImage()">
                                                Image
                                            </button>
                                        </div>
                                    </th>
                                    <th scope="col">
                                        <div class="mb-3">
                                            <button type="button" class="btn btn-info"
                                                (click)="updateSelectAllergene()">
                                                Allergenes
                                            </button>
                                        </div>
                                    </th>
                                    <th scope="col">
                                        <div class="mb-3">
                                            <button type="button" class="btn btn-info"
                                                (click)="updateSelectedOptions()">
                                                Options
                                            </button>
                                        </div>
                                    </th>
                                    <th scope="col">
                                        <div class="mb-3">
                                            <button type="button" class="btn btn-info"
                                                (click)="updateSelectedPromotions()">
                                                Statégie de promotions
                                            </button>
                                        </div>
                                   </th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <th scope="row">
                                        <div class="mb-3">
                                            <div class="mb-3">
                                                <img src="{{urlDownload}}{{selectedItem.sourceImage.gridId}}"
                                                    class="img-thumbnail text-center" width="170" />
                                            </div>
                                        </div>
                                    </th>
                                    <td>
                                        <div class="mb-3">
                                            <ul>
                                                <li
                                                    *ngFor="let allergene of selectedItem.allergenes;trackBy:util.trackById()">
                                                    {{allergene.name}}</li>
                                            </ul>
                                        </div>
                                    </td>
                                    <td>
                                        <div class="allergene-box"
                                            *ngFor="let option of this.selectedItem.options;trackBy:util.trackById;let id=index">
                                            <div style="display: inline-block;width: 300px;">
                                                <ng-container *ngIf="option.unique">
                                                    <h3>{{option.label}}</h3>
                                                    <div *ngFor="let choix of option.options;let idx=index">
                                                        <div (*ngif)="option.unique" class="form-check">
                                                            <input class="form-check-input" type="radio"
                                                                name="flexRadioDefault{{id}}" id="Default{{idx}}">
                                                            <label class="form-check-label" for="Default{{idx}}">
                                                                {{choix.label}} <span
                                                                    *ngIf="choix.price>0">{{choix.price}}€</span>
                                                            </label>
                                                        </div>
                                                    </div>
                                                </ng-container>
                                                <ng-container *ngIf="!option.unique">
                                                    <h3>{{option.label}}</h3>
                                                    <div *ngFor="let choix of option.options;let idx=index">
                                                        <div (*ngif)="option.unique" class="form-check">
                                                            <input class="form-check-input" type="checkbox">
                                                            <label class="form-check-label" for="DefaultC{{idx}}">
                                                                {{choix.label}} <span
                                                                    *ngIf="choix.price>0">{{choix.price}}€</span>
                                                            </label>
                                                        </div>
                                                    </div>
                                                </ng-container>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <div class="mb-3" *ngFor="let promotion of this.selectedItem.promotions;trackBy:util.trackById">
                                            <label>{{promotion.name}}</label>
                                            <p>{{promotion.reduction}}<span *ngIf="promotion.pourcentage">%</span><span *ngIf="!promotion.pourcentage">€</span> valable du {{promotion.dateDebut}} au {{promotion.dateFin}} de
                                                {{promotion.heureDebut}} à {{promotion.heureFin}}
                                                <span *ngIf="promotion.jourValide[0]">lundi </span>
                                                <span *ngIf="promotion.jourValide[1]">mardi </span>
                                                <span *ngIf="promotion.jourValide[2]">mercredi </span>
                                                <span *ngIf="promotion.jourValide[3]">jeudi </span>
                                                <span *ngIf="promotion.jourValide[4]">vendredi </span>
                                                <span *ngIf="promotion.jourValide[5]">samedi </span>
                                                <span *ngIf="promotion.jourValide[6]">dimanche </span>
                                                <span *ngIf="promotion.jourFerie">et jours fériés</span>
                                            </p>
                                            <hr/>
                                        </div>   
                                    </td>
                                </tr>
                            </tbody>
                        </table>

                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">fermer</button>
                    <button type="submit" class="btn btn-primary">
                        Modifier
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<div class="container">
    <h2 class="text-center">Gestion des éléments de la carte</h2>
    <form [formGroup]="filterForm">
        <div class="mb-3">
            <label class="form-label" for="addCa">Filtrer par:</label>
            <select (change)="filter()" [compareWith]="compareFn" formControlName="filter" id="addCa"
                class="form-select" aria-label="Default select">
                <option *ngFor="let categorie of categories;let idx=index;trackBy:util.trackById" [ngValue]="categorie">
                    {{categorie.name}}</option>
            </select>
        </div>
    </form>

    <button type="button" style="border-radius: 0px;margin:10px" class="btn btn-success btn-lg" data-toggle="modal"
        data-target="#addModal">
        +
    </button>

    <form>
        <table class="table">
            <tbody cdkDropList (cdkDropListDropped)="dropC($event)" class="cdk-list">
                <tr *ngFor="let item of itemsCarte;trackBy:util.trackById" class="cdk-box" cdkDrag cdkDragLockAxis="y"
                    (click)="selectItem(item)">
                    <th style="width:50px">
                        <div class="drag-handle">
                            <ng-container [ngTemplateOutlet]="dragHandleTmpl"> </ng-container>
                            {{ item.order }}
                        </div>
                    </th>
                    <td style="width:140px"><img src="{{urlDownload}}{{item.sourceImage.gridId}}" class="thumbnail"
                            width="120px" alt="{{item.sourceImage.description}}" /></td>
                    <td style="width:180px">{{item.name}}</td>
                    <td style="width:200px">{{item.description}}</td>
                    <td style="width:50px">{{item.price}}€</td>
                    <td style="width:300px">
                        <button (click)="delete(item)" style="display: inline-block; width:120px;margin:auto"
                            class="btn btn-danger">Suprimer</button>
                        <span style="margin: 10px;"> </span>
                        <button type="button" style="display: inline-block; width:120px;margin:auto"
                            class="btn btn-warning" (click)="updateDataForm(item)">
                            Modifier
                        </button>
                    </td>
                </tr>
            </tbody>
        </table>
    </form>
</div>

<ng-template #dragHandleTmpl>
    <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-arrow-down-up" fill="currentColor"
        xmlns="http://www.w3.org/2000/svg">
        <path fill-rule="evenodd"
            d="M11.5 15a.5.5 0 0 0 .5-.5V2.707l3.146 3.147a.5.5 0 0 0 .708-.708l-4-4a.5.5 0 0 0-.708 0l-4 4a.5.5 0 1 0 .708.708L11 2.707V14.5a.5.5 0 0 0 .5.5zm-7-14a.5.5 0 0 1 .5.5v11.793l3.146-3.147a.5.5 0 0 1 .708.708l-4 4a.5.5 0 0 1-.708 0l-4-4a.5.5 0 0 1 .708-.708L4 13.293V1.5a.5.5 0 0 1 .5-.5z" />
    </svg>
</ng-template>